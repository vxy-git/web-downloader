# 批量图片下载器 - Web版本

一个现代化的网页应用，支持批量下载图片到用户指定的本地文件夹。利用最新的 File System Access API 提供最佳用户体验，同时为不支持的浏览器提供兼容性方案。

## 🌟 主要特性

### 核心功能
- **文件上传支持**：支持拖拽或选择 .txt 文件上传URL列表
- **手动输入**：支持直接粘贴URL列表到文本框
- **智能解析**：自动去重和验证URL有效性
- **实时预览**：显示URL列表和统计信息

### 下载功能
- **选择文件夹**：现代浏览器支持选择任意本地文件夹
- **批量下载**：支持数千个文件的批量下载
- **并发控制**：可配置并发下载数量（推荐5-10个）
- **错误重试**：自动重试失败的下载，可配置重试次数
- **进度显示**：实时显示下载进度、速度和预计时间

### 兼容性
- **File System Access API**：Chrome 86+ 支持直接下载到指定文件夹
- **传统模式**：其他浏览器自动降级为ZIP打包下载
- **跨平台**：支持Windows、Mac、Linux等所有操作系统

## 🛠 技术实现

### 现代浏览器方案
使用 **File System Access API** 实现：
- 用户可以选择任意本地文件夹
- 文件直接保存到指定位置
- 无需额外解压操作
- 支持实时文件写入

### 兼容性方案
对于不支持的浏览器：
- 自动检测浏览器能力
- 将下载的文件打包为ZIP格式
- 用户下载ZIP文件后手动解压
- 使用 JSZip 库处理文件打包

## 📋 使用方法

### 1. 准备URL列表
创建一个 `.txt` 文件，每行一个图片URL：
```
https://example.com/image1.jpg
https://example.com/image2.png
https://example.com/image3.gif
```

### 2. 上传文件或粘贴URL
- **方式一**：拖拽 .txt 文件到上传区域
- **方式二**：点击"选择文件"按钮
- **方式三**：直接在文本框中粘贴URL列表

### 3. 配置下载参数
- **最大并发数**：同时下载的文件数量（推荐5-10个）
- **失败重试次数**：下载失败时的重试次数（推荐3次）
- **请求间隔**：两次请求之间的延迟（避免服务器限制）

### 4. 选择下载文件夹
- **现代浏览器**：点击"选择下载文件夹"选择任意位置
- **传统浏览器**：文件将以ZIP格式下载到默认下载文件夹

### 5. 开始下载
点击"开始下载"按钮，实时监控下载进度：
- 总进度条显示
- 成功/失败统计
- 下载速度和预计时间
- 详细的下载日志

## 🎯 浏览器支持

### 完整功能支持
- **Chrome 86+**：完整支持所有功能
- **Edge 86+**：完整支持所有功能

### 兼容模式支持
- **Firefox**：ZIP下载模式
- **Safari**：ZIP下载模式
- **其他浏览器**：ZIP下载模式

## ⚡ 性能特点

### 下载优化
- **并发下载**：可配置的并发数量，提高下载效率
- **智能重试**：失败后自动重试，避免手动干预
- **延迟控制**：防止请求过于频繁被服务器限制
- **内存优化**：流式处理，避免大文件占用过多内存

### 用户体验
- **实时反馈**：详细的进度显示和状态更新
- **错误处理**：友好的错误提示和恢复建议
- **响应式设计**：适配桌面和移动设备
- **无需安装**：纯网页应用，即开即用

## 🔧 配置选项

### 下载配置
```javascript
{
    maxConcurrent: 5,      // 最大并发数 (1-20)
    retryCount: 3,         // 重试次数 (0-10)
    delay: 200            // 请求间隔毫秒 (0-5000)
}
```

### 推荐设置
- **小批量下载（<100个文件）**：并发数3-5，延迟100ms
- **中等批量下载（100-1000个文件）**：并发数5-8，延迟200ms
- **大批量下载（>1000个文件）**：并发数8-10，延迟300ms

## 📊 统计和日志

### 实时统计
- 总文件数量
- 下载成功数量
- 下载失败数量
- 当前活跃下载数

### 详细日志
- 每个文件的下载状态
- 错误信息和重试记录
- 时间戳记录
- 可导出失败URL列表

## 🚀 部署说明

### 本地使用
1. 下载所有文件到本地文件夹
2. 使用本地服务器运行（推荐）：
   ```bash
   # Python 3
   python -m http.server 8000

   # Node.js
   npx serve .
   ```
3. 在浏览器中访问 `http://localhost:8000`

### 在线部署
- 支持部署到任何静态网站托管服务
- 推荐使用HTTPS以支持File System Access API
- 无需后端服务器，纯前端实现

## ⚠️ 注意事项

### 安全限制
- File System Access API 需要HTTPS环境
- 用户需要明确授权文件夹访问权限
- 不能获取文件夹的完整系统路径

### 性能建议
- 避免同时下载过多文件（推荐不超过20个并发）
- 大文件或慢网络下适当增加延迟
- 监控网络状况，必要时暂停下载

### 兼容性
- 某些防病毒软件可能阻止批量下载
- 部分网站可能有防爬虫限制
- 移动浏览器功能可能受限

## 🔄 更新日志

### v1.0.0 (2024-09-29)
- ✅ 实现File System Access API支持
- ✅ 添加ZIP下载兼容模式
- ✅ 完整的进度显示和统计
- ✅ 错误处理和重试机制
- ✅ 响应式UI设计
- ✅ 拖拽上传支持

## 📞 技术支持

如遇到问题或需要帮助：
1. 检查浏览器版本和兼容性
2. 确认网络连接状态
3. 查看浏览器控制台错误信息
4. 尝试减少并发数量或增加延迟

---

**注意**：此工具仅用于合法的文件下载用途，请遵守相关网站的使用条款和版权规定。